<%
    let portfolioData = [
        {
            title: 'WePeiyang 4.0',
            tag: 'Software | 2019',
            link: 'https://github.com/Cyphexl/WePeiYang-RN',
            imgurl: 'wepeiyang4.jpg'
        },
        {
            title: 'Martini',
            tag: 'Software | 2018',
            link: 'https://www.behance.net/gallery/88332575/Martini-App',
            imgurl: 'martini.png'
        },
        {
            title: 'Yonder',
            tag: 'Branding | 2019',
            link: 'https://www.behance.net/gallery/82499511/-YONDER',
            imgurl: 'yonder.jpg'
        },
        {
            title: 'Know',
            tag: 'Software | 2018',
            link: 'https://www.behance.net/gallery/68681739/Know',
            imgurl: 'know.jpg'
        },
        {
            title: 'Nineteen',
            tag: 'Illustration | 2017',
            link: 'https://www.behance.net/gallery/68682667/Nineteen',
            imgurl: 'nineteen.jpg'
        },
        {
            title: 'Fed Teaching Slides',
            tag: 'Presentation | 2017-2019',
            link: 'https://www.behance.net/gallery/88357567/Fed-Teaching-Slides',
            imgurl: 'fed-teaching-slides.jpg'
        },
        {
            title: 'Stats Comics',
            tag: 'Research | 2020',
            link: 'https://statscomics.github.io',
            imgurl: 'stats-comics.jpg'
        },
        {
            title: 'Slabrush',
            tag: 'Typeface Design | 2016',
            link: 'https://www.foundertype.com/index.php/News/newsdetails/id/18.html',
            imgurl: 'slabrush.jpg'
        },
        {
            title: 'Tompølevos',
            tag: 'Digital Art | 2017',
            link: 'https://www.behance.net/gallery/68687983/Tompoelevos',
            imgurl: 'tompolevos.jpg'
        },
        {
            title: 'Tianjin University Rebranding',
            tag: 'Branding | 2017',
            link: 'https://www.behance.net/gallery/68683553/Tianjin-University-Rebranding',
            imgurl: 'tju-tube.jpg'
        },
        {
            title: 'nCoVis',
            tag: 'Visualization | 2020',
            link: 'https://ncovis.github.io/choropleth/',
            imgurl: 'ncovis.jpg'
        },
        {
            title: 'Parascence',
            tag: 'Digital Art | 2016',
            link: 'https://www.behance.net/gallery/68822861/Parascence',
            imgurl: 'parascence.jpg'
        },
        {
            title: 'Lighting the Map Together',
            tag: 'Data Visualization | 2019',
            link: 'https://github.com/Cyphexl/lightmap',
            imgurl: 'lightmap.jpg'
        },
        {
            title: 'Nankai 1904-2014',
            tag: 'Digital Art | 2014',
            link: 'https://www.behance.net/gallery/68823099/-1904-2014',
            imgurl: 'nankai.jpg'
        }
    ]

    const toPng = url => url.split('.').slice(0,-1).join('.') + '.png'

%>

<p class="page-note inverta" hidden>
    Links are external. When you click on an image, be prepared to leave this site. <br />
    Customers located in Mainland China may need a VPN to browse Behance - May I politely express my concern towards
    internet censoring here.<br /><br />
    以下为外部链接，您将被重定向至 Behance 或其它作品页面。请注意，您可能需要搭建科学上网环境来浏览 Behance。<br />
    和您一样，我苦恼于互联网审查。
    <i class="fas fa-sign-in-alt ambienta"></i>
</p>

<div id='portfolio' class="dw">
    <% portfolioData.forEach((artwork) => { %>
    <a href="<%= artwork.link %>" class='single-block dw-panel unstyled'>
        <div class='single-block-fence'>
            <img class="single-block-image dw-panel__content img-deferred" src="data:image/png;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=" data-src="index/<%= artwork.imgurl %>">
            <div class="single-block-loading">
                <img src="index/loading.svg">
            </div>
            <img class="single-block-image-placeholder dw-panel__content" src="index/placeholders/<%= toPng(artwork.imgurl) %>">
            <div class="single-block-content">
                <span class='artwork-title hugo-degrec'>
                    <%= artwork.title %>
                </span>
            </div>
        </div>
    </a>
    <% }) %>
</div>

<style>
    body {
        background: #222;
    }

    #header {
        filter: invert(1)
    }

    .page-note {
        line-height: 1.3;
        padding: 20px;
        position: relative;
        overflow: hidden;
    }

    .page-note .ambienta {
        position: absolute;
        font-size: 200px;
        opacity: 0.1;
        right: 10px;
        bottom: -10px;
    }

    .single-block {
        display: flex;
        justify-content: center;
        align-items: center;
        transition: all .2s;
        perspective: 1000px;
        -webkit-perspective: 1000px;
    }

    .single-block-fence {
        /* transform: rotateY(-180deg);
        transform-style: preserve-3d; */
        filter: grayscale(1);
        transition: all 2s ease-in;
        width: 100%;
    }

    .single-block:hover .single-block-fence {
        /* transform: rotateY(0deg); */
        filter: grayscale(0);
        transition: all .1s;
    }

    .single-block-loading {
        position: absolute;
        width: 100%;
        height: 100%;
        padding: 20%;
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: -2;
        font-size: 100px;
    }

    .single-block-image {
        position: absolute;
        z-index: -1;
        opacity: 0;
        transition: all 1s;
    }

    .single-block-image-placeholder {
        position: relative;
        z-index: -3;
    }

    .title-container {
        transition: all .2s;
        position: relative;
    }

    .artwork-title {
        top: 10px;
        left: 10px;
        position: absolute;
    }

    .single-block-content {
        position: absolute;
        top: 0;
        left: 0;
    }
</style>

<%- css('lib/bricks/driveway.css') %>

<script>

function loadRealPortfolioImgs() {
    let imgDefer = document.querySelectorAll('.img-deferred');
    imgDefer.forEach(img => {
        if (img.getAttribute('data-src')) {
            img.setAttribute('src',img.getAttribute('data-src'));
            img.addEventListener('load', () => {
                img.style.opacity = '1'
                img.parentElement.querySelector('.single-block-loading').style.display = 'none';
            });     
        }
    })
}
window.onload = loadRealPortfolioImgs

</script>